This is an improvement from version 4 and might be incomplete

this is a bugfix and currently beta
